# JobSonar v5.2

Комплексная система мониторинга вакансий с умным расписанием, фильтрацией по навыкам, поддержкой удаленки и автономной системой контроля работоспособности.

## Модули
1. **HR Bot (main.py)**: Поиск управленцев (HRD, HRBP). Двухуровневый фильтр (Роль + HR).
2. **Analyst Bot (main_analyst.py)**: Поиск аналитиков. Фильтр по навыкам (SQL, Kafka, BPMN).
3. **Sales Bot (main_sales.py)**: Поиск менеджеров по продажам. Жесткая фильтрация "чистой" удаленки и B2B.
4. **Monitor Bot (monitor.py)**: Служебный модуль для контроля состояния системы, сбора логов и уведомлений об ошибках.

## Новые возможности (v5.2)

### Система мониторинга и стабильности
* **Monitor Bot**: Отдельный процесс, который проверяет работоспособность остальных ботов (HR, Analyst, Sales).
* **Автоматические уведомления**: При падении любого бота администратор мгновенно получает уведомление в Telegram с текстом ошибки (Traceback).
* **Интерактивный статус**: В боте мониторинга доступна кнопка "Обновить статус" для проверки состояния системы в реальном времени.
* **Логирование**: Ошибки записываются в отдельные файлы (log_hr.txt, log_sales.txt и др.), а не просто выводятся в консоль.
* **Авто-очистка логов**: Встроенный механизм проверяет размер лог-файлов каждые 30 минут. Если файл превышает 5 МБ, он автоматически обрезается, оставляя только последние записи.

### Технические улучшения
* **Безопасность**: Токены и ID чатов для мониторинга вынесены в файл .env.
* **Timezone Correction**: Все отчеты и логи теперь синхронизированы с Московским временем (UTC+3).
* **Infinity Polling**: Улучшенный механизм соединения с серверами Telegram для защиты от разрывов связи.

## Основные фильтры (Sales Bot)
* **Anti-Person**: Алгоритм блокировки вакансий от ИП и физлиц (анализ ФИО, окончаний, отсутствия корпоративных маркеров).
* **Strict Remote**: Блокировка скрытых офисных вакансий (фильтры: "на месте", "разъездной", "территория").
* **Currency Control**: Допуск только RUR, USD, EUR (блокировка KZT и других валют).
* **Anti-Spam**: Скрытие дублей одной и той же вакансии внутри одного цикла проверки.

## Установка и запуск

1. Заполнить файл `.env` токенами для всех ботов (включая MONITOR_TOKEN).
2. Вставить список компаний в `whitelist.py` (UTF-8).
3. Установить зависимости:
   `pip install -r requirements.txt`
4. Запуск производится через `screen` с перенаправлением вывода в лог-файлы:

```bash
# HR Bot
screen -S hr -d -m bash -c "python3 -u main.py > log_hr.txt 2>&1"

# Analyst Bot
screen -S analyst -d -m bash -c "python3 -u main_analyst.py > log_analyst.txt 2>&1"

# Sales Bot
screen -S sales -d -m bash -c "python3 -u main_sales.py > log_sales.txt 2>&1"

# Monitor Bot
screen -S monitor -d -m python3 monitor.py