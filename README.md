# JobSonar Monitoring System

Комплексная система автоматизированного мониторинга вакансий на платформе HeadHunter. Проект разделен на два независимых модуля для отслеживания управленческих HR-позиций и технических аналитиков с фильтрацией по стеку технологий.

## Архитектура проекта

Система состоит из двух изолированных скриптов, использующих общую базу данных для исключения дублей, но разную логику фильтрации.

### 1. Модуль HR (main.py)
Предназначен для поиска руководящих позиций в сфере HR (HRD, HRBP, Head of Recruitment).

* **Логика фильтрации**: Двухуровневая проверка (Dual-Key). Вакансия считается валидной только при наличии HR-контекста И управленческого маркера (Director, Head, Lead).
* **Режимы поиска**:
    * *Whitelist*: Мониторинг списка утвержденных компаний (топ-400) с порогом зарплаты от 200 000 руб.
    * *Global*: Поиск удаленных вакансий по всему рынку. Пропускаются вакансии без указания зарплаты (во избежание мусора) либо с зарплатой выше 250 000 руб.
* **Стоп-слова**: Исключение линейных позиций, IT-рекрутеров, КДП и смежных административных ролей.

### 2. Модуль Analyst (main_analyst.py)
Предназначен для поиска аналитиков (Business, Data, Product, BI) на основе требуемых навыков, а не только названий.

* **Логика фильтрации**:
    * *Skill-based matching*: Поиск ключевых технологий в описании (SQL, BPMN, Python, Tableau, Kafka и др.).
    * *Threshold*: Вакансия проходит отбор только при совпадении минимум 2-х ключевых навыков из целевого списка.
* **Гео-фильтр**: Жесткая блокировка регионов (Казахстан, Беларусь) и локаций вне целевых рынков.
* **Blacklist**: Исключение роли "Системный аналитик" (System Analyst) и позиций начального уровня (Junior, Intern).

## Функциональные возможности

* **Дистанционное управление**: Поддержка команды "stop" через Telegram-чат для корректного завершения работы скриптов.
* **Защита от самосрабатывания**: Игнорирование собственных сообщений бота и команд, отправленных до запуска текущей сессии.
* **База данных**: SQLite для хранения истории отправленных вакансий (deduplication).
* **Уведомления**: Структурированные сообщения в Telegram с автоматическим определением формата работы и уровня зарплаты.

## История изменений (Changelog)

### 08.01.2026

**Core (HR Module) v3.14**
* Внедрен механизм игнорирования старых сообщений при запуске (fix: loop termination).
* Исправлена логика глобального поиска: вакансии без указанной зарплаты теперь проходят фильтр при соответствии ключевым словам, если не нарушают нижний порог.
* Оптимизирован вывод в консоль (padding для читаемости логов).
* Обновлен список стоп-слов для банковского сектора.

**Analyst Module v1.1**
* Релиз отдельного модуля для поиска аналитиков.
* Реализован алгоритм поиска по стеку технологий (навыки) вместо прямого совпадения заголовков.
* Добавлен фильтр "минимум 2 навыка" для отсечения нерелевантных вакансий.
* Внедрен черный список для системных аналитиков и жесткий гео-фильтр (исключение стран СНГ).

## Настройка и запуск

1.  **Конфигурация**:
    * Создайте файл `.env` с токенами: `TG_TOKEN_HR`, `TG_CHAT_ID_HR`, `TG_TOKEN_TECH`, `TG_CHAT_ID_TECH`.
    * Обновите `whitelist.py` списком целевых компаний.

2.  **Запуск модулей**:
    * HR-мониторинг: `python main.py`
    * Analyst-мониторинг: `python main_analyst.py` (или через `start_analyst.bat` для Windows).